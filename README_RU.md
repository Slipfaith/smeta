# RateApp

> –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–≤–æ–¥—á–µ—Å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

RateApp ‚Äî –Ω–∞—Å—Ç–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Python/PySide6, –∫–æ—Ç–æ—Ä–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥—á–µ—Å–∫–∏—Ö –∞–≥–µ–Ω—Ç—Å—Ç–≤. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Trados/Smartcat, Outlook, Excel –∏ SharePoint/OneDrive, –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å —Å–∫–∏–¥–∫–∏, –Ω–∞—Ü–µ–Ω–∫–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –≥–æ—Ç–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç—É.

---

## ‚ú® –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìã –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã
- —Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞, –∫–ª–∏–µ–Ω—Ç–∞, –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–≥–æ –ª–∏—Ü–∞, e-mail, –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –ª–∏—Ü–∞ –∏ –≤–∞–ª—é—Ç—ã —Ä–∞—Å—á—ë—Ç–∞;
- –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (RU/EN) –∏ —è–∑—ã–∫–∞ —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü;
- –¥–∏–∞–ª–æ–≥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥–∂–µ–∫—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∏ –∞–≤—Ç–æ–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ–π –¥–∞–Ω–Ω—ã—Ö;
- –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∞–≤–æ–∫ –ù–î–° –∏ —Ä–µ–∂–∏–º–∞ ¬´—Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞ –∏ –ø–æ–≤—Ç–æ—Ä—ã¬ª.

### üåç –Ø–∑—ã–∫–æ–≤—ã–µ –ø–∞—Ä—ã –∏ —Å—Ç–∞–≤–∫–∏
- —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Å–ª–æ–≤–∞—Ä—è–º–∏ —è–∑—ã–∫–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ;
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–¥–æ–≤ —á–µ—Ä–µ–∑ `langcodes` –∏ `Babel`;
- –æ–∫–Ω–æ **¬´–ü–∞–Ω–µ–ª—å —Å—Ç–∞–≤–æ–∫¬ª** —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π –∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º –∑–Ω–∞—á–µ–Ω–∏–π Excel —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏;
- –º–∞—Å—Å–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–∫–∏–¥–æ–∫, –Ω–∞—Ü–µ–Ω–æ–∫ –∏ –±–ª–æ–∫–æ–≤ —É—Å–ª—É–≥ —Å—Ä–∞–∑—É –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∞—Ä.

### üì• –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
#### –û—Ç—á—ë—Ç—ã CAT-—Å–∏—Å—Ç–µ–º
- –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ XML-–æ—Ç—á—ë—Ç–æ–≤ Trados –∏ Smartcat –ø—Ä—è–º–æ –≤ –æ–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è;
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –æ–±—ä—ë–º–æ–≤ –∏ –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π.

#### –ü–∏—Å—å–º–∞ Outlook
- –æ–±—Ä–∞–±–æ—Ç–∫–∞ `.msg` —Ñ–∞–π–ª–æ–≤ (—á–µ—Ä–µ–∑ `extract_msg`) –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Ç–∞–±–ª–∏—Ü —É—Å–ª—É–≥;
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ COM-–∫—ç—à–∞ Outlook –Ω–∞ Windows –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

#### –¢–∞—Ä–∏—Ñ–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- –∑–∞–≥—Ä—É–∑–∫–∞ Excel-–ª–∏—Å—Ç–æ–≤ (`R1_*`, `R2_*`) —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –∫ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø–∞—Ä–∞–º;
- –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Microsoft 365 —á–µ—Ä–µ–∑ Microsoft Graph —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π MSAL –ø–æ –ø—É—Ç–∏ –∏–ª–∏ `fileId`.

### üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- –ø–µ—Ä–µ—Å—á—ë—Ç –∏—Ç–æ–≥–æ–≤ –ø–æ –≤—Å–µ–º –±–ª–æ–∫–∞–º —É—Å–ª—É–≥ —Å —É—á—ë—Ç–æ–º —Å–∫–∏–¥–æ–∫/–Ω–∞—Ü–µ–Ω–æ–∫ –∏ –≤–∞–ª—é—Ç–Ω—ã—Ö –æ–∫—Ä—É–≥–ª–µ–Ω–∏–π;
- –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∞–ª—é—Ç —á–µ—Ä–µ–∑ `online_rates.py` —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –∫—É—Ä—Å–∞;
- —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–º ¬´–ó–∞–ø—É—Å–∫ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–º¬ª —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ —Ä–∞–±–æ—Ç–∞–º–∏, —Å–∫–∏–¥–∫–∞–º–∏ –∏ –Ω–∞—Ü–µ–Ω–∫–∞–º–∏;
- —É—á—ë—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª—É–≥ —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º–∏ –µ–¥–∏–Ω–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π.

### üì§ –≠–∫—Å–ø–æ—Ä—Ç –∏ —à–∞–±–ª–æ–Ω—ã
- —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ JSON —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏;
- –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü —Å—Ç–∞–≤–æ–∫ –≤ Excel —Å –±—Ä–µ–Ω–¥–∏–Ω–≥–æ–º –∫–æ–º–ø–∞–Ω–∏–∏;
- —ç–∫—Å–ø–æ—Ä—Ç PDF —á–µ—Ä–µ–∑ COM-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Excel –Ω–∞ Windows;
- –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–æ–≤ –∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `templates/`.

### üìä –õ–æ–≥–∏ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Markdown-–ª–æ–≥–∏ –∑–∞–ø—É—Å–∫–æ–≤ –∏ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ `logs/` –∏–ª–∏ `~/.smeta/logs`;
- –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –ª–æ–≥—É —á–µ—Ä–µ–∑ ¬´–ü—Ä–æ–µ–∫—Ç ‚Üí –û—Ç–∫—Ä—ã—Ç—å –ª–æ–≥¬ª;
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ ¬´–∑–∞–≤–∏—Å—à–∏—Ö¬ª –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ Excel –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
.
‚îú‚îÄ‚îÄ main.py                      # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ gui/                         # –í–∏–¥–∂–µ—Ç—ã PySide6 –∏ –∫–æ–º–ø–æ–∑–∏—Ü–∏—è UI
‚îÇ   ‚îú‚îÄ‚îÄ main_window.py           # –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –∏ –º–µ–Ω—é
‚îÇ   ‚îú‚îÄ‚îÄ panels/                  # –õ–µ–≤–∞—è/–ø—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª–∏ —Å —Ñ–æ—Ä–º–∞–º–∏ –∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ additional_services.py   # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏
‚îÇ   ‚îú‚îÄ‚îÄ project_setup_widget.py  # –ó–∞–ø—É—Å–∫ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ project_manager_dialog.py# –î–∏–∞–ª–æ–≥ –ø—Ä–æ–¥–∂–µ–∫—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ rates_manager_window.py  # –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ logic/                       # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ calculations.py          # –†–∞—Å—á—ë—Ç—ã –∏—Ç–æ–≥–æ–≤ –∏ –≤–∞–ª—é—Ç
‚îÇ   ‚îú‚îÄ‚îÄ project_manager.py       # –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å UI
‚îÇ   ‚îú‚îÄ‚îÄ project_data.py          # –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–Ω–∏–º–æ–∫ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ project_io.py            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ JSON-–ø—Ä–æ–µ–∫—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ rates_importer.py        # –ò–º–ø–æ—Ä—Ç —Ç–∞—Ä–∏—Ñ–æ–≤ –∏–∑ Excel
‚îÇ   ‚îú‚îÄ‚îÄ outlook_import/          # –ü–∞—Ä—Å–∏–Ω–≥ Outlook `.msg`
‚îÇ   ‚îú‚îÄ‚îÄ sc_xml_parser.py         # –ü–∞—Ä—Å–µ—Ä –æ—Ç—á—ë—Ç–æ–≤ Smartcat
‚îÇ   ‚îú‚îÄ‚îÄ trados_xml_parser.py     # –ü–∞—Ä—Å–µ—Ä –æ—Ç—á—ë—Ç–æ–≤ Trados
‚îÇ   ‚îú‚îÄ‚îÄ ms_graph_client.py       # –ö–ª–∏–µ–Ω—Ç Microsoft Graph
‚îÇ   ‚îú‚îÄ‚îÄ online_rates.py          # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∞–ª—é—Ç
‚îÇ   ‚îú‚îÄ‚îÄ activity_logger.py       # Markdown-–∂—É—Ä–Ω–∞–ª –¥–µ–π—Å—Ç–≤–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ env_loader.py            # –ü–æ–∏—Å–∫ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ `.env`
‚îÇ   ‚îú‚îÄ‚îÄ service_config.py        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ logging_utils.py         # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ user_config.py           # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ services/                    # –õ—ë–≥–∫–∏–µ –∞–¥–∞–ø—Ç–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ excel_export.py          # –≠–∫—Å–ø–æ—Ä—Ç Qt-—Ç–∞–±–ª–∏—Ü (LogTab, MemoQ)
‚îÇ   ‚îî‚îÄ‚îÄ ms_graph.py              # –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ Microsoft Graph
‚îú‚îÄ‚îÄ rates1/                      # –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏ —Ç–∞—Ä–∏—Ñ–æ–≤
‚îú‚îÄ‚îÄ templates/                   # –®–∞–±–ª–æ–Ω—ã Excel/PDF –∏ —Ä–µ—Å—É—Ä—Å—ã
‚îú‚îÄ‚îÄ utils/                       # –£—Ç–∏–ª–∏—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –∏—Å—Ç–æ—Ä–∏–∏
‚îú‚îÄ‚îÄ tests/                       # –ù–∞–±–æ—Ä pytest-—Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ requirements.txt             # –°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ main.spec                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PyInstaller
‚îî‚îÄ‚îÄ resource_utils.py            # –ü–æ–∏—Å–∫ —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ dev –∏ —Å–±–æ—Ä–∫–µ
```

–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–º. –≤ [ARCHITECTURE_RU.md](ARCHITECTURE_RU.md).

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.11

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # Windows: .venv\Scripts\activate
   ```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install -r requirements.txt
   ```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   ```bash
   python main.py
   ```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

- **Windows + Excel** ‚Äî —Ç—Ä–µ–±—É—é—Ç—Å—è –¥–ª—è PDF-—ç–∫—Å–ø–æ—Ä—Ç–∞ –∏ —Ä–∞–±–æ—Ç—ã —Å COM (`pywin32`).
- **Outlook `.msg`** ‚Äî –∏–º–ø–æ—Ä—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ `extract_msg`.
- **–ò–Ω—Ç–µ—Ä–Ω–µ—Ç** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞—Ä–∏—Ñ–æ–≤ –∏–∑ Microsoft 365 –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ –≤—Ä—É—á–Ω—É—é.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
pytest
```

–ù–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç —Ä–∞—Å—á—ë—Ç—ã, –ø–∞—Ä—Å–∏–Ω–≥ XML/Outlook, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —ç–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç.

---

## üì¶ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.11** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä
- **PySide6** ‚Äî –Ω–∞—Å—Ç–æ–ª—å–Ω—ã–π UI –Ω–∞ Qt
- **pandas** –∏ **openpyxl** ‚Äî —Ç–∞–±–ª–∏—á–Ω—ã–µ —Ä–∞—Å—á—ë—Ç—ã –∏ Excel
- **Pillow** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –∏–∫–æ–Ω–æ–∫
- **langcodes** –∏ **Babel** ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —è–∑—ã–∫–æ–≤ –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
- **requests** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Microsoft Graph
- **msal** ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Microsoft 365
- **psutil** ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ Excel
- **extract_msg** ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ Outlook `.msg`
- **python-dotenv** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **pywin32** *(Windows)* ‚Äî COM-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è PDF-—ç–∫—Å–ø–æ—Ä—Ç–∞

---

## üíæ –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**`languages.json`** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —è–∑—ã–∫–∏, —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤:
- Windows: `%APPDATA%/ProjectCalculator`
- macOS: `~/Library/Application Support/ProjectCalculator`
- Linux: `~/.config/ProjectCalculator`

**`pm_history.json`** ‚Äî –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–¥–∂–µ–∫—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

**`logic/legal_entities.json`** ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü.

---

## üî® –°–±–æ—Ä–∫–∞ standalone-–≤–µ—Ä—Å–∏–∏

```bash
pyinstaller main.spec
```

Spec-—Ñ–∞–π–ª —É–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç —à–∞–±–ª–æ–Ω—ã, –¥–∞–Ω–Ω—ã–µ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–π Babel/langcodes –∏ –∏–∫–æ–Ω–∫—É. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ —Å–ø–∏—Å–æ–∫ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏–ª–∏ –∏–º—è –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞.

---

## üìù –õ–æ–≥–∏ –∏ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

- ¬´–ü—Ä–æ–µ–∫—Ç ‚Üí –û—Ç–∫—Ä—ã—Ç—å –ª–æ–≥¬ª –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –ª–æ–≥. –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `./logs`, `~/.smeta/logs` –∏–ª–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ.
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `activity.log` —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∏, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, —Å–Ω–∏–º–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

---

## ü§ù –í–∫–ª–∞–¥

–ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –ø—É–ª-—Ä–µ–∫–≤–µ—Å—Ç–∞:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `pytest` –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç.
2. –û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è UI –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏–º–ø–æ—Ä—Ç–∞/—ç–∫—Å–ø–æ—Ä—Ç–∞.

–ü—Ä–∏ —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ–± –æ—à–∏–±–∫–µ —É–∫–∞–∂–∏—Ç–µ –≤–µ—Ä—Å–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —à–∞–≥–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∏ –ø—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–∏—Ç–µ –ª–æ–≥.
